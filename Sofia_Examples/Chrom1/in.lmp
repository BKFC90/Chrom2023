
################################
#Template
#Must contain the variables
#  typecell 
#  outtraj
#  outfile
#  radius
#  interaction
#  run_length
#  samplingrate
#  particle


# VARIABLES

variable RUNID string 'Normal_F7-10M-1'

# Initialization
#correspond to x=y=z=1
lattice fcc 4
units		lj
boundary	f f f
atom_style	molecular

read_data chrom.init

region R1 sphere 0 0 0 27 side out

mass * 1.00

neighbor 0.5 multi

comm_modify mode single cutoff 20.0

include variables
include softinteractions

group particle type 1 2 3
group normal type 1 2
group telo type 3

variable rad equal 30

region mySphere sphere 0.0 0.0 0.0 v_rad side in

fix walln normal wall/region mySphere lj126 ${eps_ne} ${sigma_ne} ${sigma_ne}
fix wallt telo wall/region mySphere  lj126 ${eps_te} ${sigma_te} ${sigma_ne}

dump	I all image 50000 *.jpg type type bond type type size 1000 1000 view 60 120
dump_modify I backcolor white boxcolor black
dump_modify I adiam * 0.75
dump_modify I adiam 3 2.0
dump_modify I adiam 4 2.0
dump_modify I adiam 5 3.0
dump_modify I adiam 6 0.4
dump_modify I acolor 1 lightgreen
dump_modify I acolor 2 lightblue
dump_modify I acolor 3 red
dump_modify I acolor 4 blue
dump_modify I acolor 5 green
dump_modify I acolor 6 black
dump_modify I bdiam 1 0.1
dump_modify I bcolor 1 gray
dump_modify I bdiam 2 0.75
dump_modify I bcolor 2 gray

dump	M all movie 1000 movie.mp4 type type bond type type size 1000 1000 view 60 120
dump_modify M backcolor white boxcolor black
dump_modify M adiam * 0.75
dump_modify M adiam 3 2.0
dump_modify M adiam 4 2.0
dump_modify M adiam 5 3.0
dump_modify M adiam 6 0.4
dump_modify M acolor 1 lightgreen
dump_modify M acolor 2 lightblue
dump_modify M acolor 3 red
dump_modify M acolor 4 blue
dump_modify M acolor 5 green
dump_modify M acolor 6 black
dump_modify M bdiam 1 0.1
dump_modify M bcolor 1 gray
dump_modify M bdiam 2 0.75
dump_modify M bcolor 2 gray


fix		1 particle nve/limit 0.001
fix		lang particle langevin $T $T 1.0 ${langseed}

thermo_style	custom step temp ke pe
thermo          1000

#
# initial run with 'soft' interactions
#

run 10000

#
# now use 'real' interactions
#

include interactions

unfix walln
unfix wallt
fix walln normal wall/region mySphere lj126 ${eps_ne} ${sigma_ne} ${cut_ne}
fix wallt telo wall/region mySphere  lj126 ${eps_te} ${sigma_te} ${cut_te}

unfix 1
fix		1 particle nve/limit 0.0001

run 10000

#
# gradually increase limiting particle movement range
#

unfix 1
fix		1 particle nve/limit 0.0005

run 10000

#
# now move to production run
#

unfix 1
fix		1 particle nve/limit 0.05

run 450000
